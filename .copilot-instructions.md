# Copilot Instructions for Home Assistant Add-on Repository

## Context
This repository contains Home Assistant add-ons. When generating or modifying code, follow Home Assistant add-on development standards.

## Key Rules

### Dockerfiles
- Use `ARG BUILD_FROM` and `FROM $BUILD_FROM` (no default value)
- Use `apk add` for packages, NOT `pip install` (avoids PEP 668 errors)
- Consolidate RUN commands for efficiency
- Include required packages: `bash`, `jq` for most add-ons

### Configuration (config.json)
- Always include: name, version, slug, description, arch
- Use proper schema validation types
- Set appropriate permissions (minimal required)
- Use `"arch": ["amd64", "armv7", "aarch64"]` for multi-arch support
- **IMPORTANT**: Update version number whenever ANY file in the add-on changes

### Scripts (run.sh)
- Start with `#!/usr/bin/with-contenv bashio`
- Use `bashio::config 'option'` or `jq` to read `/data/options.json`
- Include `set -e` for error handling
- End daemon scripts with `tail -f /dev/null`

### Repository Structure
- Use `repository.yaml` (NOT json)
- Point URLs to repository root, not subfolders
- Follow: `name:`, `url:`, `maintainer:` format

### Common Patterns
```bash
# Read config
CONFIG_PATH=/data/options.json
VALUE=$(jq --raw-output '.option_name' "$CONFIG_PATH")

# Or with bashio
VALUE=$(bashio::config 'option_name')
```

```dockerfile
# Standard Dockerfile pattern
ARG BUILD_FROM
FROM $BUILD_FROM

RUN apk add --no-cache bash jq curl

COPY run.sh /
RUN chmod a+x /run.sh

CMD [ "/run.sh" ]
```

## When in doubt, prefer Home Assistant conventions over generic Docker patterns.